import {Socket} from "phoenix"

$(() => {
  let camera_id = window.Evercam.Camera.id;

  let socket = new Socket("<%= EvercamDashboard::Application.config.websockets_url %>")

  socket.connect();

  let chan = socket.chan(`cameras:${camera_id}`, {})

  chan.join().receive("ok", ({messages}) => {
    if ($.inArray(camera_id, recording_cameras) !== -1) {
      window.snapshot_streaming_enabled = true;
    }
  })

  chan.on("snapshot-taken", payload => {
    $("#live-player-image").attr("src", "data:image/jpeg;base64," + payload.image);
  })
})
