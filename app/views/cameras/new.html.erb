
<div class="boxed-page">
  <div class="container clearfix">
    <section id="container" >
      <!--header start-->
      <header class="header box-head">
        <div class="nav notify-row col-lg-12" id="top_menu">
          <div class="col-xs-10">
            <a class="btn btn-add" href="/cameras/new" role="button"><span class="glyphicon glyphicon-plus"></span>
              <span>Add A Camera</span></a>
          </div>
        </div>
      </header>
      <!--header end-->
      <!--sidebar start-->
      <div id="sidebar" class="nav-collapse col-lg-2 col-xs-12">
        <!-- sidebar menu start-->
        <ul class="sidebar-menu" id="nav-accordion">
          <li class="sub-menu">
            <a href="/">
              <span class="glyphicon glyphicon-camera"></span>
              <span>  My Cameras</span>
            </a>
            <ul class="sub">
              <li><a href="">Mast Wicklow</a></li>
              <li><a href="single-camera.html">Rememberance Cam</a></li>
              <li><a href="">Rooftop Cam</a></li>
              <li><a href="">Reykjavik Harbour</a></li>
              <li><a href="#">Washington Uni</a></li>
            </ul>
          </li>
        </ul>
        <!-- sidebar menu end-->
      </div>
      <!--sidebar end-->
      <!--main content start-->
      <div class="col-lg-10 col-xs-12 wrapper">
        <section id="main-content">
          <div class="col-lg-12">

            <h3>Add A Camera</h3>

            <form action="#" method="post">
              <%= hidden_field_tag :authenticity_token, form_authenticity_token -%>

              <!-- STEP 1 -->
              <fieldset>
                <hr>
                <div class='row'>

                  <div class='col-lg-3'>
                    <span class="label label-primary">1</span><h5>Evercam Camera Info</h5>
                  </div>

                  <div class='col-lg-3 form-group'>
                    <label class="control-label" for="camera-name">Evercam Camera Name</label>
                    <span data-toggle="tooltip" data-title="This is the friendly name you will give to your Camera to identify it in the Evercam Dashboard" class="label label-default">?</span>
                    <input id="camera-name" name="camera-name" placeholder="Rooftop Camera" class="form-control input-sm" required="" type="text" value="<%= params['camera-name'] %>">
                  </div>

                  <div class='col-lg-3 form-group'>
                    <label class="control-label" for="camera-id">Evercam Camera ID</label>
                    <span data-toggle="tooltip" data-title="This the ID you have to create for your Camera that will need to be Unique for Evercam." class="label label-default">?</span>
                    <input id="camera-id" name="camera-id" placeholder="roof-cam" class="form-control input-sm" required="" type="text" value="<%= params['camera-id'] %>">
                  </div>

                </div>
                </hr>
              </fieldset>

              <!-- STEP 2 -->
              <fieldset>
                <hr>
                <div class='row'>

                  <div class='col-lg-3'>
                    <span class="label label-primary">2</span><h5>Cameras Credentials</h5>
                  </div>

                  <div class='col-lg-3 form-group'>
                    <label class="control-label" for="camera-username">Camera Username</label>
                    <span data-toggle="tooltip" data-title="The camera you are trying to connect will already have a Username that you will need to enter here. It will have been created by the camera owner" class="label label-default">?</span>
                    <input id="camera-username" name="camera-username" placeholder="admin" class="form-control input-sm" type="text" value="<%= params['camera-username'] %>">
                  </div>

                  <div class='col-lg-3 form-group'>
                    <label class="control-label" for="camera-password">Camera Password</label>
                    <span data-toggle="tooltip" data-title="The camera you are trying to connect will already have a Password that will have been created by the camera owner" class="label label-default">?</span>
                    <input id="camera-password" name="camera-password" placeholder="12345" class="form-control input-sm" type="text" value="<%= params['camera-password'] %>">
                  </div>

                </div>
                </hr>
              </fieldset>

              <!-- STEP 3 -->
              <fieldset>
                <hr>
                <div class='row'>

                  <div class='col-lg-3'>
                    <span class="label label-primary">3</span><h5>Path to your Camera</h5>
                  </div>

                  <div class='col-lg-5'>

                    <div class='row'>
                      <div class='col-lg-8 form-group'>
                        <label class="control-label" for="camera-url">Camera URL or IP</label>
                        <span data-toggle="tooltip" data-title="This will just contain the IP address in the form of 149.237.192.68 - http:// is already included" class="label label-default">?</span>
                        <div class="input-group">
                          <span class="input-group-addon">http://</span>
                          <input id="camera-url" name="camera-url" placeholder="149.237.192.68" class="form-control input-sm" required="" type="text"  value="<%= params['camera-url'] %>">
                        </div>
                      </div>

                      <div class='col-lg-4 form-group'>
                        <label class="control-label" for="port">Port</label>
                        <!--<span data-toggle="tooltip" data-title="The snapshot URL is the path to where the cameras snapshots are currently stored." class="label label-default">?</span>-->
                        <input id="port" name="port" placeholder="8901" class="form-control input-sm" required="" type="text" data-validation="length" data-validation-length="min4" value="<%= params['port'] %>">
                      </div>
                    </div>

                    <div class='row'>
                      <div class='col-lg-12 form-group'>

                        <label class="control-label" for="snapshot">Snapshot URL</label>
                        <span data-toggle="tooltip" data-title="The snapshot URL is the path to where the cameras snapshots are currently stored." class="label label-default">?</span>
                        <input type="text" id="snapshot" name="snapshot" placeholder="/snapshot/jpg" class="form-control input-sm" value="<%= params['snapshot'] %>" >

                      </div>
                    </div>


                    <div class='col-lg-12 panel panel-default panel-body'>
                      Space for validation error
                    </div>


                  </div>

                  <div class='col-lg-3'>
                    <div class="media">
                      <img id="testimg" src="/" width="100%">
                    </div>
                    <p class="text-center"><a href="#" id="test" class="btn btn-primary ladda-button" role="button" data-style="expand-left"><span class="ladda-label">Test Snapshot</span></a></p>
                    <p class="text-center"><span data-toggle="tooltip" data-placement="top" data-title="If you have entered the correct Credentials, Camera URL/IP and Port into the fields to the left, the image above should show you what your camera is seeing right now. If there is no preview, then some of the information you have entered could be incorrect. Please check the info or refer to your Camera's Manual." class="label label-default">?</span></p>
                  </div>

                </div>

                </hr>
              </fieldset>



              <!-- STEP 4 -->
              <fieldset>
                <hr>
                <div class='row'>

                  <div class='col-lg-3'>
                    <span class="label label-primary">4</span><h5>Optional Camera Fields</h5>
                  </div>

                  <div class='col-lg-3 form-group'>
                    <label class="control-label" for="camera-username">Camera Vendor</label>
                    <span data-toggle="tooltip" data-title="The camera you are trying to connect will already have a Username that you will need to enter here. It will have been created by the camera owner" class="label label-default">?</span>
                    <input id="camera-username" name="camera-username" placeholder="admin" class="form-control input-sm" type="text" value="<%= params['camera-username'] %>">
                  </div>

                  <div class='col-lg-3 form-group'>
                    <label class="control-label" for="camera-password">Camera Model</label>
                    <span data-toggle="tooltip" data-title="The camera you are trying to connect will already have a Password that will have been created by the camera owner" class="label label-default">?</span>
                    <input id="camera-password" name="camera-password" placeholder="12345" class="form-control input-sm" type="text" value="<%= params['camera-password'] %>">
                  </div>

                </div>
                </hr>
              </fieldset>



              <!-- FINISH & ADD -->

              <fieldset>
                <div class='row'>
                  <div class="col-lg-2"></div>

                  <!-- Button -->
                  <div class='col-lg-5 col-lg-offset-1'>
                    <div class="form-group">
                      <label class="control-label" for="add-button"></label>
                      <button id="add-button" name="add-button" class="btn btn-success">Finish &amp; Add</button>
                    </div>
                  </div>
                </div>

              </fieldset>


              <!-- SUPPORT -->
              <div class="row">
                <div class='col-lg-5 col-lg-offset-3 panel panel-default panel-body'>
                  <p>Still Can't See Your Camera?</p>
                  <ul class="list-inline">
                    <li><a href="#">FAQ/common-connection-issues</a></li>
                    <li><a href="#">Get our Support Team to connect your Camera</a></li>
                  </ul>
                </div>
              </div>

            </form>




          </div>
        </section>
        <!--main content end-->
      </div>
    </section>
  </div>
</div> <!--boxed page end-->
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-form-validator/2.1.47/jquery.form-validator.min.js"></script>
<script>
    $(function () {
        $('body').popover({
            selector: '[data-toggle="popover"]'
        });

        $('body').tooltip({
            selector: 'a[rel="tooltip"], [data-toggle="tooltip"]'
        });

        $('#test').click(function(e) {
            var params = ['external_url=http://' + $('#camera').val() + ':' + $('#port').val(), 'jpg_url=' + $('#snapshot').val(),
                'cam_username=' + $('#camera-username').val(), 'cam_password=' + $('#camera-password').val()];
            e.preventDefault();
            var l = Ladda.create(this);
            l.start();
            var progress = 0;
            var interval = setInterval( function() {
                progress = Math.min( progress + 0.025, 1 );
                l.setProgress( progress );

                if( progress === 1 ) {
                    l.stop();
                    clearInterval( interval );
                }
            }, 200 );
            $.getJSON('https://dashboard.evercam.io/v1/cameras/test.json?' + params.join('&'))
                    .done(function(resp) {
                        console.log('success');
                        $('#testimg').attr('src', resp.data);
                    })
                    .fail(function() {
                        console.log('error');
                    })
                    .always(function() {
                        l.stop();
                        clearInterval( interval );
                    });
        });



    });

</script>
