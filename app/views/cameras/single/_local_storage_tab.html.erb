<div evercam="localstorage"></div>

<script type="text/javascript" src="https://s3.amazonaws.com/cdn.evercam.io/js/localstorage/0.0.1/hikvision.local.storage.mini.js"></script>
<script type="text/javascript">
  window.localwidgetLoaded = false;

  $(document).ready(function () {
    if (window.location.hash === '#local_storage' && !window.localwidgetLoaded) {
      initLocalStorage();
    }
  });

  $('.tabbable-custom').on('click', 'a[data-toggle="tab"]', function () {
    if ($(this).attr('href') === '#local_storage' && !window.localwidgetLoaded) {
      initLocalStorage();
    }
  });

  function initLocalStorage() {
    window.localwidgetLoaded = true;
    LocalStorage.options.cameraId = '<%= @camera['id'] %>';
    LocalStorage.options.api_id = '<%= current_user.api_id -%>';
    LocalStorage.options.api_key = '<%= current_user.api_key -%>';
    LocalStorage.Load();
  }

</script>
