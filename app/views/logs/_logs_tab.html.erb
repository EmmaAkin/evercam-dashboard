<link rel="stylesheet" type="text/css" href="//cdn.datatables.net/1.10.0/css/jquery.dataTables.css">
<script type="text/javascript" src="//cdn.datatables.net/1.10.0/js/jquery.dataTables.js"></script>
<div class="col-lg-12 info-panel">
  <h4>Logs</h4>

  <div class="col-md-12 filter">
    <h5>Events</h5>
    <div id="types">
      <label class="checkbox-inline">All<input id="all-types" value="" type="checkbox" /> </label>
      <% @types.each do |t| %>
      <label class="checkbox-inline">
       <%= t.capitalize %><input name="type" type="checkbox" value="<%= t %>" <% if params[:types] and params[:types].include?(t) %> checked<% end %> />
      </label>
      <% end %>
    </div>
    <h5>Date &amp; Time Range</h5>
    <div class="col-md-12" id="date-box">
      <div class="row">
        <div class="col-md-3">
          From: <input id="datetimepicker" class="datetimepicker" type="text" value="<%= Time.at(params[:from].to_i).strftime('%Y/%m/%d %H:%M') unless params[:from].blank? %>">
        </div>
        <div class="col-md-3">
          To: <input id="datetimepicker2" class="datetimepicker" type="text" value="<%= Time.at(params[:to].to_i).strftime('%Y/%m/%d %H:%M') unless params[:to].blank? %>">
        </div>
      </div>
    </div>
    <div class="col-md-1">
      <input id="current-page" type="hidden" value="<%= @page + 1 %>">
      <input id="exid" type="hidden" value="<%= @camera['id'] %>">
      <input id="base-url" type="hidden" value="<%= "#{EVERCAM_API}cameras/#{params[:id]}/logs?api_id=#{current_user.api_id}&api_key=#{current_user.api_key}&objects=true&limit=10000" %>">
      <input id="ajax-url" type="hidden" value="<%= "#{EVERCAM_API}cameras/#{params[:id]}/logs?api_id=#{current_user.api_id}&api_key=#{current_user.api_key}&objects=true&limit=10000" %>">
      <button id="apply-types" class="btn btn-primary pull-right">Filter</button>
    </div>
  </div>

  <div class="row">
    <div class="col-md-12">
      <table id="logs-table" class="table table-logs">
        <thead>
          <th>Date &amp; Time</th>
          <th>Event</th>
          <th>User/Client</th>
        </thead>
        <tbody>
          <% @logs.each do |l| %>
          <tr>
            <td>On <span class="bold"><%= Time.at(l['done_at']).to_formatted_s(:rfc822) unless l['done_at'].nil? %></span></td>
            <td><span class="bold"><%= l['action'] %></span></td>
            <td>
              <% unless ['online', 'offline'].include?l['action'] %>
                by <span class="bold"><%= l['who']  %></span>
              <% end %>
            </td>
          </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div><!-- row -->

</div><!-- info panel -->

<script type="text/javascript">
  $(window.Evercam.Logs.initializeTab);
</script>