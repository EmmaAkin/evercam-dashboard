<script src="https://maps.google.com/maps/api/js?sensor=true"></script>
<div class="bb-alert alert alert-info" style="display:none;">
  <span></span>
</div>
<div class="page-container">
  <!-- sidebar menu start-->
  <div class="page-sidebar-wrapper">
    <div class="page-sidebar navbar-collapse collapse">

      <ul class="page-sidebar-menu" data-auto-scroll="true" data-slide-speed="200">
        <!--<li class="sidebar-toggler-wrapper">
          <div class="sidebar-toggler">
          </div>
        </li>-->
        <li>
          <a href="/"><i class="icon-camera"></i>My Cameras</a>
        </li>
        <li>
          <a class="active" href="/publiccam"><i class="icon-map"></i>Public Cameras</a>
        </li>

        <li>
          <a href="/cameras/new"><i class="icon-plus"></i>Add Camera</a>
        </li>
        <li>
          <a href="/dev"><i class="icon-briefcase"></i>Developer</a>
        </li>

      </ul>
    </div>
  </div>
  <!-- sidebar menu end-->
  <div class="page-content-wrapper">
    <div class="page-content">

    <div id="public-cam-single" class="">
      <div class="portlet">

        <!--progress bar start-->
        <div class="portlet-title">
          <div class="caption">
            <i class=​"fa fa-camera">​</i><%= @camera['name'] %>
          </div>
          <div class="tools">
            <div class="caption">
            <a href="#" class="create-share-button btn evercam-btn pull-right" camera_id="<%= @camera["id"] %>" email="<%= @user.email %>"><span class="glyphicon glyphicon-plus"></span>Add to Cameras Shared With Me</a>
            </div>
          </div>
        </div>

        <div class="portlet-body">
          <div class="row">
          <div class="col-lg-8 camera-image">
            <% if @camera['is_online'] %>
            <img src="<%= @camera['jpg'] %>" width="100%">
            <% else %>
              <div class="offline-public">
                <div class="offline-text">
                  <p>This camera appears to be offline.</p>
                  <p>We are currently unable to fetch a snapshot.</p>
                </div>
              </div>
            <% end %>
          </div>
          <div class="col-lg-4 data">
            <table class="table table-borderless">
              <tr>
                <td>Status:</td>
                <td>
                  <% if @camera['is_online'] %>
                    <span class="green">Online</span>
                  <% else %>
                    <span class="red">Offline</span>
                  <% end %>
                </td>
              </tr>
              <tr>
                <td>Vendor:</td>
                <td><%= @camera["vendor_name"] %></td>
              </tr>
              <tr>
                <td>Model:</td>
                <td><%= @camera['model'] %>

                </td>
              </tr>
              <tr>
                <td>Date Added:</td>
                <td><%= Time.at(@camera['created_at']).to_formatted_s(:long_ordinal) %></td>
              </tr>
              <tr>
                <td>Location:</td>
                <td><%= @camera.deep_fetch(:location, :lat) {} %>, <%= @camera.deep_fetch(:location, :lng) {} %></td>
              </tr>
            </table>
            <div id="map-public"></div>
          </div>
          </div>
        </div>

      </div>
    </div>

    <div class="row">
      <div class="col-md-12">
        <span class="btn btn-default"><span class="glyphicon glyphicon-arrow-left"></span><%= link_to 'Back to map', '/publiccam' %></span
      </div>
    </div>

  </div>
</div>


  <%= javascript_tag do %>
    cameraLong = '<%= @camera.deep_fetch(:location, :lng) {} %>';
    cameraLat = '<%= @camera.deep_fetch(:location, :lat) {} %>';
    <% end %><%= javascript_include_tag "publiccam" %>
<script>
  $(window.Evercam.Publiccam.initialize);

  function initialize() {
    var cameraLatlng = new google.maps.LatLng(cameraLat, cameraLong);
    var mapOptions = {
      zoom: 12,
      center: cameraLatlng,
      mapTypeControl: false,
      streetViewControl: false
    }
    var map = new google.maps.Map(document.getElementById('map-public'), mapOptions);

    var marker = new google.maps.Marker({
      position: cameraLatlng,
      map: map,
      title: 'Camera Location'
    });

  }
  google.maps.event.addDomListener(window, 'load', initialize);

</script>