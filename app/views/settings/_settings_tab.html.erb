<form action="#" method="post">
  <%= hidden_field_tag :authenticity_token, form_authenticity_token -%>
  <div class='row'>
    <div class="col-md-4">
      <h4>Settings</h4>

        
    </div>
  </div>

  <!-- STEP 1 -->
  <fieldset>
    <div class="row">
      <div class='col-lg-12'>
        <div class='col-lg-4 form-group'>
          <label class="control-label" for="camera-id">Evercam ID</label>
          <div class="well-set"><%= @camera['id'] %></div>
          <input type="hidden" name="camera-id" value="<%= @camera['id'] %>">
        </div>
      </div>
    </div>
    <div class="row">
      <div class='col-lg-12'>
        <div class='col-lg-4 settings form-group'>
          <label class="control-label" for="camera-name">Friendly Name</label>
          
          <input id="camera-name" class="form-control readonly readonly makeEditable" type="text" value="Remembrance Cam" data-validation-error-msg="Can contain letters, numbers, spaces and hyphens." data-validation-allowing="-_ " data-validation="alphanumeric" required="" placeholder="Rooftop Camera" name="camera-name" readonly="readonly">
        </div>
        <div class='col-lg-12 col-lg-offset-3 edit'>
             <i class="glyphicon glyphicon-pencil"></i>
          </div>

          <div class="left-inner-addon lock">
            <i class="glyphicon glyphicon-lock"></i>
            <input type="button" value="" class="makeNonEditable" />
          </div>
        
      </div>
    </div>
    
    

  </fieldset>

  <!-- STEP 2 -->
  <fieldset>
    <div class='row'>
      <div class='col-lg-12'>
        <div class='col-lg-4 form-group'>
          <label class="control-label" for="camera-username">Camera Username</label>
          <input id="camera-username" name="camera-username" placeholder="" class="form-control" type="text" value="<%= @camera['cam_username'] %>">
        </div>
      </div>
    </div>  
    <div class='row'>
      <div class='col-lg-12'>  
        <div class='col-lg-4 form-group'>
          <label class="control-label" for="camera-password">Camera Password</label>
          <input id="camera-password" name="camera-password" placeholder="" class="form-control" type="text" value="<%= @camera['cam_password'] %>">
        </div>
      </div>
    </div>
  </fieldset>

  <!-- STEP 3 -->
  <fieldset>
    <div class='row bottom'>
      <div class='col-lg-10'>
        <div class='col-lg-8'>
          <div class='row'>
            <div class='col-lg-10 form-group'>
              <label class="control-label" for="camera-url">External IP (or URL)</label>
              <div class="input-group">
                <span class="input-group-addon">http://</span>
                <input id="camera-url" name="camera-url" placeholder="149.237.192.68" class="form-control" required="" type="text" data-validation="custom" data-validation-regexp="^[a-zA-Z0-9._/-]{2,100}$" data-validation-error-msg="This doesn't appear to be a valid IP." value="<%= @camera['external_host'] %>">
              </div>
            </div>
          </div>
          <div class='row'>
            <div class='col-lg-5 form-group'>
              <label class="control-label" for="port">External HTTP Port</label>
              <input id="port" name="port" placeholder="8901" class="form-control" required="" type="text" data-validation="custom" data-validation-regexp="^[0-9]{2,5}$"  data-validation-error-msg="The Port should be a 2-5 digit number." value="<%= @camera['external_http_port'] %>">
            </div>
            <div class='col-lg-5 form-group'>
              <label class="control-label" for="ext-rtsp-port">External RTSP Port</label>
              <input id="ext-rtsp-port" name="ext-rtsp-port" placeholder="554" class="form-control" type="text" data-validation="custom" data-validation-regexp="^[0-9]{2,5}$"  data-validation-error-msg="The Port should be a 2-5 digit number." data-validation-optional="true" value="<%= params['ext-rtsp-port'] %>">
            </div>
          </div>
          <div class='row'>
            <div class='col-lg-10 form-group'>
              <label class="control-label" for="snapshot">Snapshot URL</label>
              <input type="text" id="snapshot" name="snapshot" placeholder="/snapshot.jpg" class="form-control" data-validation="custom" data-validation-regexp="^/[a-zA-Z0-9._/-]{2,100}$" data-validation-error-msg="This doesn't appear to be a valid URL" value="<%= @camera['jpg_url'] %>" >
            </div>
          </div>

        </div>
        <div class='col-lg-4'>
          <div class="media">
            <img id="testimg" src="/" class="text-center" width="100%">
          </div>
          <div class="test-snapshot"><a href="#" id="test" class="btn btn-primary ladda-button" role="button" data-style="expand-left"><span class="ladda-label">Test Snapshot</span></a></div>
        </div>
      </div>
    </div>
  </fieldset>

  <fieldset>
  <div class="row">
    <div class='col-lg-10'>
      <div class="col-lg-7">
        <!-- STEP 4 -->
        <div class='row'>
          <div class='col-lg-6 form-group'>
            <label class="control-label" for="camera-vendor">Camera Vendor</label>
            <select id="camera-vendor" name="camera-vendor" class="form-control">
              <option selected="selected" value="-1">-- select model --</option>
              <% @vendors.each_with_index  do |v, index| -%>
                  <option value="<%= v.exid -%>" <% if v.exid == @camera['vendor'] %>selected="selected"<% end %>>
                    <%= v.name -%>
                  </option>
              <% end %>
            </select>
          </div>

          <div class='col-lg-6 form-group'>
            <%# @camera['model'] %>
            <label class="control-label" for="camera-model">Camera Model</label>
            <% @vendors.each do |v| -%>
                <select id="camera-model<%= v.exid -%>" name="camera-model" class="form-control  <% if v.exid != @camera['vendor'] %>hidden<% end %>">
                  <% v.vendor_models.each_with_index  do |m, index| -%>
                      <% if index == 0 %>
                          <option value="<%= m.name -%>" ><%= m.name -%></option>
                      <% else %>
                          <option value="<%= m.name  -%>" <% if m.name == @camera['model'] %>selected="selected"<% end %> ><%= m.name -%></option>
                      <% end %>
                  <% end -%>
                </select>
            <% end %>
          </div>
        </div>
        <div class="row">
          <div class='col-lg-8 form-group'>
            <label class="control-label" for="local-ip">Local IP</label>
            <input id="local-ip" name="local-ip" placeholder="" class="form-control" type="text" data-validation="custom" data-validation-regexp="^[a-zA-Z0-9._/-]{2,100}$"  data-validation-error-msg="The Port should be a 2-4 digit number." data-validation-optional="true" value="<%= params['local-ip'] %>">
          </div>
        </div>
        <div class="row">
          <div class='col-lg-6 form-group'>
            <label class="control-label" for="local-http">Local HTTP Port</label>
            <input id="local-http" name="local-http" placeholder="" class="form-control" type="text" data-validation="custom" data-validation-regexp="^[0-9]{2,5}$"  data-validation-error-msg="The Port should be a 2-5 digit number." data-validation-optional="true" value="<%= params['local-http'] %>">
          </div>
          <div class='col-lg-6 form-group'>
            <label class="control-label" for="local-rtsp">Local RTSP Port</label>
            <input id="local-rtsp" name="local-rtsp" placeholder="" class="form-control" type="text" data-validation="custom" data-validation-regexp="^[0-9]{2,5}$"  data-validation-error-msg="The Port should be a 2-5 digit number." data-validation-optional="true" value="<%= params['local-rtsp'] %>">
          </div>
        </div>


      </div>
    </div>
  </div>
  </fieldset>
  <!-- FINISH & ADD -->
  <fieldset>
    <div class='row'>
      <div class="text-center finish">
        <!-- Button -->
        <div class='col-lg-12'>
          <div class="form-group">
            <label class="control-label" for="add-button"></label>
            <button id="add-button" name="add-button" class="alert btn btn-primary">Save</button>
          </div>
        </div>
      </div>
    </div>
  </fieldset>

  <!-- SUPPORT -->
  <div class="row add-footer">

    <div class='col-lg-10 col-lg-offset-1'>
      <h5>Still Can't See Your Camera?</h5>
      <ul class="list-inline">
        <li><a href="http://www.evercam.io/help" target="_blank">Help Pages</a></li>
        <li><a href="#" target="_blank">Support</a></li>
      </ul>
    </div>
  </div>

</form>

<script type="text/javascript">
$(window.Evercam.Settings.initializeTab);
$(function(){
    $(".makeNonEditable").click(function(){
        $('input:text').attr("readonly", "readonly");    
    });    
        $(".makeEditable").click(function(){
        $('input:text').removeAttr("readonly");    
    });
})
 <% unless flash[:message].blank? %>
            bootbox.alert("<%= flash[:message] %>", function() {
                console.log("Alert Callback");
            });
        <% end %>

</script>