<!--PERMISSIONS: is_public?=<%= @camera['is_public'] %>-->

<div class="row margin-bottom-30">
  <div class="col-md-2">
    <h5>This Camera Is:</h5>
  </div>
    <div class="col-md-8">
        <div class="col-md-12 text-left sharing">

            <label class="radio">
              <input type="radio" name="sharingOptionRadios" id="sharingOptionRadios1" value="public_discoverable" <%= "checked" if @camera["is_public"] && @camera["discoverable"] %>>
              <p>Public on the web <small> -  Public: [Yes]  &amp; Discoverable: [Yes]</small></p>
            </label>


            <label class="radio">
              <input type="radio" name="sharingOptionRadios" id="sharingOptionRadios2" value="public_undiscoverable" <%= "checked" if @camera["is_public"] && !@camera["discoverable"] %>>
              <p>Available to anyone with the link <small> - Public: [Yes]  &amp; Discoverable: [No]</small></p>
            </label>


            <label class="radio">
              <input type="radio" name="sharingOptionRadios" id="sharingOptionRadios2" value="private" <%= "checked" if !@camera["is_public"] %>>
              <p>Available to specific people <small> - Public: [No]  &amp; Discoverable: [No]</small></p>
            </label>

        </div>
    </div>
      <div class="col-md-2 pull-right">
          <input type="hidden" name="sharing_tab_camera_id" id="sharing_tab_camera_id" value="<%= @camera["id"] %>"></input>
          <a href="#" type="button" data-dismiss="modal"  id="set_permissions_submit" class="btn btn-primary pull-right">Save</a>
      </div>
</div>
<!--END SHARING MODAL-->

<!--USER LIST-->
  <div class="row">
    <div class="col-md-12">
<% unless @camera_shares.empty? and @share_requests.empty? %>
     <h5>This Camera is Shared With</h5>
      <table class="table table-striped table-bordered table-hover table-full-width" id="sharing_list_table">
        <thead>
        <tr>
          <th>Email</th>
          <th>Permissions</th>
          <th></th>
          <th></th>
        </tr>
        </thead>
        <tbody>
      <% if @camera_shares %>
        <% @camera_shares.each do |share| %>
          <!--
             <%= raw("#{share}") %>
          -->
          <% rights = share["rights"].split(",") %>
          <tr share-id="<%= share["id"] %>">
            <td class="col-lg-4">
              <%= share["email"] %>
                <% if share["email"] == current_user.email %>
                <small class="blue"> (you)</small>
                <% end %>
                </td>
            <td class="col-lg-2">
              <div class="input-group">
                <% if share["email"] == current_user.email %>
                  <select class="form-control reveal disabled" disabled show-class="show-save">
                <% else %>
                    <select class="form-control reveal" show-class="show-save">
                <% end %>
                    <option <%= "selected" if !rights.include?("View") %> value="minimal">Read Only</option>
                    <option <%= "selected" if rights.include?("View") %> value="full">Full Rights</option>
                  </select>
              </div>
            </td>
            <td class="col-lg-2">
              <button type="submit" class="save show-save btn btn-primary update-share-button">Save</button>
            </td>
            <td class="col-lg-2">
              <div class="form-group">
                  <span class="delete-share-control" camera_id="<%= @camera["id"] %>" share_id="<%= share["id"] %>"><span class="glyphicon glyphicon-remove"> </span>Remove</span>
              </div>
            </td>
          </tr>
        <% end %>
      <% end %>
      <% if @share_requests %>
          <% @share_requests.each do |share_request| %>
            <% rights = share_request["rights"].split(",") %>
            <tr share-request-id="<%= share_request["id"] %>">
              <td class="col-lg-4"><%= share_request["email"] %><small class="blue">  ...pending</small></td>
              <td class="col-lg-2">
                <div class="input-group">
                  <select class="form-control reveal" show-class="show-save">
                    <option <%= "selected" if !rights.include?("View") %> value="minimal">Read Only</option>
                    <option <%= "selected" if rights.include?("View") %> value="full">Full Rights</option>
                  </select>
                </div>
              </td>
              <td class="col-lg-2">
                <button type="submit" class="save show-save btn btn-primary update-share-request-button">Save</button>
              </td>
              <td class="col-lg-2">
                <div class="form-group">
                  <span class="delete-share-request-control" camera_id="<%= @camera["id"] %>" email="<%= share_request["email"] %>"><span class="glyphicon glyphicon-remove"> </span>Revoke</span>
                </div>
              </td>
              </td>

            </tr>
          <% end %>
        <% end %>
        </tbody>
      </table>
    </div>
  </div>
        <% else %>
      None
        <% end %>


<!--ADD A USER-->

  <div class="row padding-top-20">
      <div class="col-sm-3 email-input">
        <div class="input-group">
          <h5>Share camera with</h5> <input type="email" placeholder="email@domain.com or Username" class="form-control" id="sharingUserEmail" name="sharingUserEmail">
        </div>
      </div>
      <div class="col-sm-2">
        <div class="input-group">
          <select id="sharingPermissionLevel" class="form-control">
            <option>Read Only</option>
            <option>Full Rights</option>
          </select>
        </div>
      </div>
      <div class="col-sm-2">
        <div class="form-group share-camera">
          <button type="submit" class="btn btn-primary" id="submit_share_button">Share</button>
        </div>
      </div>
    <!--<div class="col-md-10">
      <p>
        <span class="note">If the email address doesn't have an account associated with it, a link will be sent to that email address to create an account in order to see the camera. The camera share will show as pending until the account is created. </span>
      </p>
    </div>-->
  </div>


<!--LINK TO SHARE-->
<div class="row margin-top-30">
  <div class="col-md-6 share-link">
    <h5>Link to Share Camera</h5>
  <div>
      <div id="public-short-page" class="show-on-public" style="<%= 'display: none;' unless @camera['is_public'] %>">
        <%= link_to "http://evr.cm/#{@camera['id']}.html", "http://evr.cm/#{@camera['id']}.html", target: '_blank', :only_path => false %>
      </div>
      <div id="private-short-page" class="show-on-private" style="<%= 'display: none;' if @camera['is_public'] %>">
        <%= "http://evr.cm/#{@camera['id']}.html" %>
      </div>
  </div>
</div>
  <div class="col-md-12">
    <p>
      <span class="note show-on-private">Only available for public cameras. You can change this in your settings above.</span>
    </p>
  </div>

</div><!-- panel body -->



<script type="text/javascript">
  $(window.Evercam.Share.initializeTab);
</script>