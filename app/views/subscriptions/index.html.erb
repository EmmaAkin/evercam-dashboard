<div class="bb-alert alert alert-info" style="display:none;">
  <span></span>
</div>
<div class="subscriptions page-content-wrapper">
  <div class="page-content">
    <%# render partial: "users/section_header", locals: { section_header_title: "Billing" } %>
    <div class="portlet-body">
      <%= render 'navigation' %>
      <div class="col-md-12">
        <h3>Cards</h3>
        <%= render partial: 'shared/stripe' %>

        <% if has_credit_cards? %>


          <% @credit_cards.each do |card| -%>
          <p><i class="fa fa-credit-card"></i>
            <strong> <%= card.brand -%></strong> exp. <strong><%= card.exp_month -%>&#47;<%= card.exp_year %></strong> ending in <strong>..<%= card.last4 -%></strong>
            <i><%= default_card?(card.id) ? ' - default card' : (link_to '', stripe_customer_path({:card_id => card.id, :default_source => true}), method: :put) %></i></p>
          <% end -%>

          <a class="" data-toggle="modal" data-target="#myModal">
            Manage Cards
          </a>
          <%= render 'manage_cards' %>
        <% else %>
          <p>You have no card added</p>
          <%= render 'add_card' %>
        <% end %>
      </div>

      <div class="margin-top-30 col-md-12">
        <h3>Plan</h3>
        <p>Your on the <strong><%= render 'current_subscription' %></strong> plan</p>
        <%= link_to 'Change your Plan', plans_path(current_user.username) %>
      </div>
      <div class="col-md-12 margin-top-30 margin-bottom-30">
        <h3>Add-ons</h3>
        <% unless @add_ons.present? %>
          <p>You have no add-ons</p>
        <% end %>
        <%= render 'current_add_ons' %>
      </div>
    </div>
  </div>
</div>

<script>
  window.initializeSubscription();
  <% if flash[:message] %>
  Notification.show('<%= flash[:message] %>');
  <% end %>
</script>
