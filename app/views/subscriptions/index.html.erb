<div class="bb-alert alert alert-info" style="display:none;">
  <span></span>
</div>
<div class="subscriptions page-content-wrapper">
  <div class="page-content">
    <%# render partial: "users/section_header", locals: { section_header_title: "Billing" } %>
    <div class="portlet-body">

        <%= render 'navigation' %>

          <div class="col-md-12">
            <h3>Cards</h3>
            <%= render partial: 'shared/stripe' %>
             <p class="margin-top-15">Your Card(s):</p>
               <!-- New Stripe customer -->
               <% unless is_stripe_customer? %>
                 <p>You have not yet associated a credit card with this account.</p>
               <% end %>

                <% if has_credit_cards? %>
                <% @credit_cards.each do |card| -%>
                  <p><strong><%=  card.brand -%></strong> expires <strong><%= card.exp_month -%>&#47;<%= card.exp_year %></strong> ending in ..<strong><%= card.last4 -%></strong></p>
                <% end -%>
                <% end %>
                <% if stripe_customer_without_current_cards? %>
                  You have no current cards associated with this account.
                <% end %>
              <div class="margin-top-15">
                <form action="<%= stripe_customers_path -%>" method="POST">
                  <%= hidden_field_tag :authenticity_token, form_authenticity_token -%>
                  <script
                  src="https://checkout.stripe.com/checkout.js" class="stripe-button"
                  data-key="<%= Rails.configuration.stripe[:publishable_key] -%>"
                  data-image="<%= asset_path('evercam-e.svg') -%>"
                  data-email="<%= current_user.email -%>"
                  data-name="Stripe.com"
                  data-description="Add Credit Card"
                  data-label="Add a Credit Card">
                  </script>
                </form>
              </div>
          </div>
          <div class="margin-top-30 col-md-12">
            <h3>Plans</h3>
            <p>Current Plan: <strong><%= render 'current_subscription' %></strong></p>
            <%= render 'plans_comparison' %>
            <div class="row">
              <div class="col-md-4">
                <div class="plan-button">
                  <div class="btn btn-primary">Select</div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="plan-button">
                <%= link_to 'Select', edit_subscription_path, class: 'btn btn-primary' %>
                </div>
              </div>
              <div class="col-md-4">
                <div class="plan-button">
                <%= link_to 'Select', edit_subscription_path, class: 'btn btn-primary' %>
                </div>
              </div>
            </div>
          </div>
      <div class="col-md-12 margin-top-30 margin-bottom-30">

        <h3>Your Add Ons</h3>
          <%= render 'current_add_ons' %>
        <% unless @add_ons.present? %>
          <p>You have no adds ons</p>
        <% end %>
        <%= link_to 'Get Add-ons', edit_add_ons_path, class: 'margin-top-20' %>
      </div>

  </div>
</div>
</div>

<script>
  window.initializeSubscription();
  <% if flash[:message] %>
  Notification.show('<%= flash[:message] %>');
  <% end %>
</script>
